"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1164],{52555:function(t,n,e){e.d(n,{Z:function(){return v},c:function(){return P}});var i=e(5593),o=e(34003),a=e(3363),l=e(62952),u=e(81451),c=e(71375),r=e(72573),s=e(83496),m=e(14200),d=e(475),f=e(8667),p=e(53002),Z=e(94678);let P=.985;async function v(t){let{coin1:n,coin2:e,liquidity:P,targetUserPositionAccount:v,currentAmmPool:A,coin1Amount:g,coin2Amount:y,coin1AmountMin:h,coin2AmountMin:b}=Z.ZP.getState(),{tokenAccountRawInfos:w}=p.Z.getState();(0,o.Z)(A,"not seleted amm pool"),(0,o.Z)(n,"not set coin1"),(0,o.Z)(e,"not set coin2"),(0,o.Z)(h,"not set coin1AmountMin"),(0,o.Z)(b,"not set coin2AmountMin"),(0,o.Z)(null!=P,"not set liquidity"),(0,o.Z)(v,"not set targetUserPositionAccount");let x=(0,l.n)(n,h,{alreadyDecimaled:!0}),k=(0,m.W)(n)?(0,s.w)({amount:x}):void 0,C=(0,l.n)(e,b,{alreadyDecimaled:!0}),S=(0,m.W)(e)?(0,s.w)({amount:C}):void 0;return(0,f.ZP)(async l=>{var s,m,f,p,Z,g;let{transactionCollector:y,baseUtils:{connection:x,owner:C,allTokenAccounts:T}}=l,[B,M]=await Promise.all([k,S]);if(null==t?void 0:t.closePosition){let{innerTransactions:t}=await i.c2c.makeDecreaseLiquidityInstructionSimple({connection:x,liquidity:P,poolInfo:A.state,ownerInfo:{feePayer:C,wallet:C,tokenAccounts:w,useSOLBalance:!0,closePosition:(0,u.eq)(v.sdkParsed.liquidity,P)},ownerPosition:v.sdkParsed,computeBudgetConfig:await (0,d.u)(),checkCreateATAOwner:!0,amountMinA:(0,c.Z)(null!==(s=null==B?void 0:B.pure)&&void 0!==s?s:h,n.decimals),amountMinB:(0,c.Z)(null!==(m=null==M?void 0:M.pure)&&void 0!==m?m:b,e.decimals)});y.add(t,{txHistoryInfo:{title:"Position Closed",description:"close ".concat((0,a.ZP)(v.poolId).slice(0,6)," position")}})}else{(0,o.Z)(h,"not set coin1AmountMin"),(0,o.Z)(b,"not set coin2AmountMin");let{innerTransactions:t}=await i.c2c.makeDecreaseLiquidityInstructionSimple({connection:x,liquidity:P,poolInfo:A.state,ownerInfo:{feePayer:C,wallet:C,tokenAccounts:w,useSOLBalance:!0,closePosition:(0,u.eq)(v.sdkParsed.liquidity,P)},amountMinA:(0,c.Z)(null!==(f=null==B?void 0:B.pure)&&void 0!==f?f:h,n.decimals),amountMinB:(0,c.Z)(null!==(p=null==M?void 0:M.pure)&&void 0!==p?p:b,e.decimals),ownerPosition:v.sdkParsed,computeBudgetConfig:await (0,d.u)(),checkCreateATAOwner:!0});y.add(t,{txHistoryInfo:{title:"Liquidity Removed",description:"Removed ".concat((0,r.B)(null!==(Z=null==B?void 0:B.pure)&&void 0!==Z?Z:h,{decimalLength:6})," ").concat(n.symbol," and ").concat((0,r.B)(null!==(g=null==M?void 0:M.pure)&&void 0!==g?g:b,{decimalLength:6})," ").concat(e.symbol," from ").concat((0,a.ZP)(v.poolId).slice(0,6))}})}})}},52784:function(t,n,e){e.d(n,{Z:function(){return u}});var i=e(67294),o=e(3363),a=e(4465),l=e(94678);function u(t){let n=(0,l.ZP)(t=>t.coin1),e=(0,l.ZP)(t=>t.coin2),u=(0,l.ZP)(t=>t.hydratedAmmPools),c=(0,l.ZP)(t=>t.currentAmmPool),r=(0,i.useCallback)(t=>{let n=void 0!==c&&1===t.filter(t=>(0,o.ZP)(t.state.id)===c.idString).length;return n},[c]);(0,i.useEffect)(()=>{if(!u.length||!n||!e){l.ZP.setState({selectableAmmPools:void 0,currentAmmPool:void 0});return}let i=u.filter(t=>(0,a.aT)(t.state.mintA.mint,n.mint)&&(0,a.aT)(t.state.mintB.mint,e.mint)||(0,a.aT)(t.state.mintA.mint,e.mint)&&(0,a.aT)(t.state.mintB.mint,n.mint)),o=r(i);l.ZP.setState(t||o?{selectableAmmPools:i}:{selectableAmmPools:i,currentAmmPool:i[0]})},[n,e,u,t])}},76961:function(t,n,e){e.d(n,{Z:function(){return A}});var i=e(5593),o=e(67294),a=e(91371),l=e(3363),u=e(62952),c=e(4465),r=e(81451),s=e(51523),m=e(71375),d=e(72573),f=e(92867),p=e(79162),Z=e(94678),P=e(14200),v=e(52555);function A(){let t=(0,a.ZP)(t=>t.slippageTolerance),n=(0,Z.ZP)(t=>t.coin1),e=(0,Z.ZP)(t=>t.coin1Amount),A=(0,Z.ZP)(t=>t.priceUpperTick),y=(0,Z.ZP)(t=>t.coin2),h=(0,Z.ZP)(t=>t.coin2Amount),b=(0,Z.ZP)(t=>t.priceLowerTick),w=(0,Z.ZP)(t=>t.userCursorSide),x=(0,Z.ZP)(t=>t.isRemoveDialogOpen),k=(0,Z.ZP)(t=>t.currentAmmPool),C=(0,Z.ZP)(t=>t.targetUserPositionAccount),S=(0,Z.ZP)(t=>t.isInput);(0,o.useMemo)(()=>x?0:t,[x,t]);let T=(0,o.useMemo)(()=>{if(k&&C){var t;return null===(t=k.positionAccount)||void 0===t?void 0:t.find(t=>(0,l.ZP)(t.nftMint)===(0,l.ZP)(C.nftMint))}},[k,C]),B=(0,o.useCallback)(async()=>{if(!k||!n||!y||null==A||null==b||x&&!1===S)return;let t="coin1"===w,o=(0,c.aT)(n.mint,k.state.mintA.mint),a=t?e:h,d=(0,l.ZP)(t?n.mint:y.mint),B=(0,l.ZP)(t?y.mint:n.mint),M=void 0!==a&&""!==a,I=t?(0,m.Z)((0,s.dC)(null!=e?e:0,10**n.decimals)):(0,m.Z)((0,s.dC)(null!=h?h:0,10**y.decimals)),[q,N]=await Promise.all([(0,p.b)({mints:[n.mint,y.mint].filter(P.W)}),(0,f.$)()]);try{let{liquidity:a,amountSlippageA:l,amountSlippageB:c}=x&&k&&T&&C&&C.amountA&&C.amountB&&(0,r.$u)(T.liquidity)?await g({inputAmountBN:I,maxLiquidity:T.liquidity,inputMint:d,outputMint:B,amountA:(0,m.Z)(T.amountA),amountB:(0,m.Z)(T.amountB),isFocus1:t,epochInfo:N}):i.c2c.getLiquidityAmountOutFromAmountIn({poolInfo:k.state,slippage:0,inputA:t&&o||!o&&!t,tickUpper:Math.max(A,b),tickLower:Math.min(b,A),amount:I,add:!x,epochInfo:N,token2022Infos:q,amountHasFee:!0}),f=o?l:c,p=o?c:l,P=(0,u.n)(n,f.amount),w=(0,u.n)(y,p.amount),S=f.expirationTime,L=p.expirationTime,O=p.fee&&(0,u.n)(y,p.fee),E=f.fee&&(0,u.n)(n,f.fee),j={coin1Amount:t?e:M?P:void 0,coin1SlippageAmount:t?(0,s.hi)(P,v.c):M?(0,s.hi)(P,v.c):void 0,coin2Amount:t?M?w:void 0:h,coin2SlippageAmount:t?M?(0,s.hi)(w,v.c):void 0:(0,s.hi)(w,v.c),coin1AmountFee:E,coin1ExpirationTime:M?S:void 0,coin2AmountFee:O,coin2ExpirationTime:M?L:void 0,liquidity:a};Z.ZP.setState(j)}catch(t){}},[n,(0,d.B)("coin1"===w?e:h),A,y,b,w,k,x,S,C,T]);(0,o.useEffect)(()=>{try{B()}catch(t){console.log("still can't calc amount",t instanceof Error?t.message:t)}},[B])}async function g(t){let{inputAmountBN:n,maxLiquidity:e,inputMint:o,outputMint:a,amountA:l,amountB:u,epochInfo:c,isFocus1:r}=t,d=(0,s.hi)(n,r?l:u),f=(0,m.Z)(r?(0,s.dC)(u,d):(0,s.dC)(l,d)),Z=await (0,p.b)({mints:[o,a]}),P=Z[o],v=Z[a];return{liquidity:(0,m.Z)((0,s.dC)(e,d)),amountA:(0,i.bfS)(r?n:f,(r?P:v).feeConfig,c,!1),amountB:(0,i.bfS)(r?f:n,(r?v:P).feeConfig,c,!1),amountSlippageA:(0,i.bfS)(r?n:f,(r?P:v).feeConfig,c,!1),amountSlippageB:(0,i.bfS)(r?f:n,(r?v:P).feeConfig,c,!1)}}},48678:function(t,n,e){e.d(n,{C:function(){return a}});var i=e(81451),o=e(72573);function a(t){if(null==t||t.toString().includes("Infinity")||isNaN(t))return"";let n=t?(0,o.B)(t):"";return(0,i.eq)(n,0)?"":n}},51488:function(t,n,e){e.d(n,{I:function(){return P}});var i=e(85893),o=e(18559),a=e(81451),l=e(3363),u=e(14200),c=e(51523);async function r(t,n){let e=(0,l.ZP)(t);if(!(0,u.W)(e))return!0;let i=(0,o.U7)(e),r=i.then(t=>!!t&&({isTransferable:!((0,a.$u)(n)&&(0,a.eg)(t.transferFeePercent,1)&&(0,a.lt)(n,(0,c.hi)(t.maximumFee,1)))}).isTransferable);return r}var s=e(28948),m=e(48162),d=e(51800),f=e(72573),p=e(99111),Z=e(67294);function P(t){let n=(0,Z.useMemo)(()=>t.map(t=>{var n;return(0,l.ZP)(null===(n=t.token)||void 0===n?void 0:n.mint)}),[t]),e=(0,Z.useMemo)(()=>t.map(t=>(0,f.B)(t.amount)),[t]),o=(0,p.Z)(async()=>{for(let{token:n,amount:e}of t)if(n){let t=await r(n.mint,e);if(!t)return n}},n.concat(e),void 0),a=!!o,u=t=>{let{className:n}=t;return(0,i.jsx)(v,{className:n,needOpen:a,badToken:o})};return{isWarningChipOpen:a,badToken:o,Token2022FeeTooHighWarningChip:u}}function v(t){let{className:n,needOpen:e,badToken:o}=t;return(0,i.jsx)(s.Z,{show:e,children:(0,i.jsx)("div",{className:n,children:(0,i.jsxs)(d.Z,{className:"bg-[#da2eef1a] text-[#da2eef] rounded-xl py-3 px-3 mobile:px-2 items-center",children:[(0,i.jsx)(m.Z,{className:"mr-1",heroIconName:"exclamation-circle",size:"smi"}),(0,i.jsx)("div",{className:"text-xs mobile:text-2xs",children:"Transfer fee at 100%, transaction will fail."})]})})})}},99023:function(t,n,e){e.d(n,{Mn:function(){return u},dO:function(){return c}});var i=e(81451),o=e(51523),a=e(84207),l=e(72616);function u(t){return t.map(t=>{let{liquidity:n,price:e}=t;return{x:Number(e),y:Number(n)}})}function c(t){let{coin1Amount:n,coin2Amount:e,currentPrice:u,coin1InputDisabled:c,coin2InputDisabled:r}=t,[s,m]=[(c?"0":n)||"0",r?"0":e],[d,f]=[(0,i.gt)(s,0),(0,i.gt)(m,0)],p=(0,a.Z)(m||"0"),Z=u?d?(0,o.dC)(s,u).add(p):f?p:(0,a.Z)(1):(0,a.Z)(1);try{let t=u?(0,o.hi)((0,o.dC)(s,u),Z):(0,l.y)(0),n=u?(0,o.hi)(p,Z):(0,l.y)(0);return{ratio1:t,ratio2:n}}catch(t){return{}}}}}]);